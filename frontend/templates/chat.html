<div class="flex flex-col h-[70vh]">
  <h2 class="text-xl font-semibold mb-4">Chat</h2>

  <!-- Chat box -->
  <div id="chat-box" class="flex-1 overflow-y-auto space-y-3 p-3 border rounded bg-gray-50">
    <p class="text-gray-500">Start chatting with the bot...</p>
  </div>

  <!-- Input -->
  <form id="chat-form" hx-post="/chat" hx-target="#chat-box" hx-swap="beforeend"
        class="mt-3 flex items-center space-x-2">
    <input id="chat-input" type="text" name="message" placeholder="Type your message..."
           class="flex-1 border border-gray-300 rounded p-2 focus:ring focus:ring-blue-200"
           autocomplete="off">
    <button type="submit"
            class="bg-blue-600 text-white px-4 py-2 rounded shadow hover:bg-blue-700">
      Send
    </button>
  </form>
</div>

<script>
  const chatBox = document.getElementById("chat-box");
  const chatInput = document.getElementById("chat-input");

  // Insert user message before sending
  document.getElementById("chat-form").addEventListener("htmx:beforeRequest", function () {
    if (chatInput.value.trim() === "") return;
    
    const userBubble = `
      <div class="flex justify-end">
        <div class="bg-blue-600 text-white px-4 py-2 rounded-lg max-w-xs shadow">
          ${chatInput.value}
        </div>
      </div>`;
    
    chatBox.insertAdjacentHTML("beforeend", userBubble);
    chatBox.scrollTop = chatBox.scrollHeight;
  });

  // Scroll down after receiving bot message
  chatBox.addEventListener("htmx:afterSwap", function () {
    chatBox.scrollTop = chatBox.scrollHeight;
  });
</script>
